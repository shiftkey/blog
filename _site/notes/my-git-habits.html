<!DOCTYPE html>

<!-- 
320 and Up boilerplate extension
Author: Andy Clarke
Version: 0.9b
URL: http://stuffandnonsense.co.uk/projects/320andup 
-->

<!--[if IEMobile 7 ]><html class="no-js iem7" manifest="default.appcache?v=1"><![endif]-->
<!--[if lt IE 7 ]><html class="no-js ie6" lang="en"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7" lang="en"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8" lang="en"><![endif]-->
<!-- TODO: appcache definition -->
<!--[if (gte IE 9)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->

<head>
<meta charset="utf-8">

<title>My Git Habits</title>
<meta name="description" content="">
<meta name="author" content="brendan forster">

<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="RSS feed"> 
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="ATOM feed"> 


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1">

<!-- robots -->
<meta name="robots" content="/robots.txt" />

<!-- For less capable mobile browsers
<link rel="stylesheet" media="handheld" href="css/handheld.css?v=1">  -->

<!-- For all browsers -->
<link href='http://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" media="screen" href="/css/style.css?v=1">

<link rel="stylesheet" media="print" href="/css/print.css?v=1">
<!-- For progressively larger displays -->
<link rel="stylesheet" media="only screen and (min-width: 480px)" href="/css/480.css?v=1">
<link rel="stylesheet" media="only screen and (min-width: 768px)" href="/css/768.css?v=1">
<link rel="stylesheet" media="only screen and (min-width: 992px)" href="/css/992.css?v=1">
<link rel="stylesheet" media="only screen and (min-width: 1382px)" href="/css/1382.css?v=1">
<!-- For Retina displays -->
<link rel="stylesheet" media="only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)" href="/css/2x.css?v=1">

<link rel="stylesheet" media="screen" href="/css/custom.css?v=1">

<!-- JavaScript at bottom except for Modernizr -->
<script src="/js/libs/modernizr-1.7.min.js"></script>

<!-- For iPhone 4 -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/h/apple-touch-icon.png">
<!-- For iPad 1-->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/m/apple-touch-icon.png">
<!-- For iPhone 3G, iPod Touch and Android -->
<link rel="apple-touch-icon-precomposed" href="/img/l/apple-touch-icon-precomposed.png">
<!-- For Nokia -->
<link rel="shortcut icon" href="/img/l/apple-touch-icon.png">
<!-- For everything else -->
<link rel="shortcut icon" href="/favicon.ico">

<!--iOS. Delete if not required -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-startup-image" href="/img/splash.png">

<!--Microsoft. Delete if not required -->
<meta http-equiv="cleartype" content="on">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<!-- http://t.co/y1jPVnT -->
<link rel="canonical" href="/notes/my-git-habits.html">


</head>

<body class="clearfix">

<header role="banner" class="clearfix">
	<h1>My Git Habits</h1>
</header>

<div class="content clearfix">

	<div id="post">
<p>First up, a disclaimer: <strong>This is just one person's opinion and should be treated as such.</strong></p>

<p>If you workflow is similar, that's great. If you workflow is radically different, that's great too. With things like git its very easy to have different workflows, so I'll just be speaking from my experiences here.</p>

<h3>Introduction</h3>

<p>Generally speaking, my git flow is based off the <a href="https://github.com/NancyFx/Nancy/wiki/Git-Workflow">documentation</a> for contributors to the NancyFx project. When working on features, this is my high-level flow:</p>

<ol>
<li>Create a local branch for the feature</li>
<li>Work on your feature and get it reviewed -- you do code reviews, right?</li>
<li>Merge the changes into master</li>
<li>Push the changes up to the remote repository</li>
</ol>


<p>How does that look from the comamnd line?</p>

<ul>
<li>git checkout -b ReallyCoolFeature master</li>
<li>... stuff gets done ...</li>
<li>git add -u .</li>
<li>git commit -m "#1234 implemented" -- associating commits with work items is awesomely helpful</li>
<li>git checkout master</li>
<li>git pull origin/master</li>
<li>git merge ReallyCoolFeature</li>
<li>git push origin master</li>
</ul>


<p><strong>Note:</strong> Yeah, I like to be explicit with my remotes and branch names in these commands. Haters gonna hate.</p>

<p>But that's all fairly straight-forward and not really leveraging the <a href="http://think-like-a-git.net/sections/git-makes-more-sense-when-you-understand-x/example-4-lsd-and-chainsaws.html">new states of mind</a> that git makes possible.</p>

<h3>Rebase all the things</h3>

<p>Where git truly comes into its own is with rebasing. For those who aren't familiar with it, rebasing allows you to change the history of a branch. This is generally considered very bad(TM) to do with public repositories but when you use it only locally it gives you so much control over everything.</p>

<p>For example, have you ever:</p>

<ul>
<li>used a branch for multiple, disparate tasks that you wish you could reorder for readability?</li>
<li>accidentally forgot to save a file and had to spread a task over multiple commits as a result?</li>
<li>wanted to update an old branch to the latest changes and avoid merge conflicts?</li>
<li>wanted to split out a branch into multiple branches and process them separately?</li>
</ul>


<p>If you consider a branch to be a chain of commits - with a parent commit representing the creation point of the branch - then rebasing is the operation to:</p>

<ul>
<li>change the creation point of a branch</li>
<li>change the order of the commits in a branch</li>
<li>change the commits in a branch - squash commits together</li>
<li>remove commits from a branch</li>
</ul>


<p>At this point you are probably thinking "Oh man, I'm going to nuke my branch and lose all my work" but if you look more closely at what the rebase does, you'll find that its a lot safer than you think.</p>

<p>A rebase operation will</p>

<ul>
<li>set the repository to the new creation point</li>
<li>create a temporary branch just for this rebase operation</li>
<li>apply the commits one by one to ensure they apply cleanly</li>
<li>update the pointers for the branch and remove the temporary branch</li>
<li>set the repository to the last commit of the new branch</li>
</ul>


<p>When I say "ensure the commits apply cleanly" here, I indicate that git will ensure that additions and subtractions to each file make sense. If they don't (for example, the file has changed significantly enough), it will pause and ask the user to manually confirm the commit.</p>

<p>At any point during a rebase that requires user input, you can abort and git will roll back to the state it was in before the rebase operation started.</p>

<h3>Speak English, Brendan!</h3>

<p>So I got side-tracked a bit just then. Apologies.</p>

<p>So what do I use rebasing for?</p>

<ul>
<li><em>reordering</em> - if I do a bit of code cleanup during my work, that remains separate from the current task and can be put before/after when reviewing code</li>
<li><em>squashing</em> - generally speaking, your commits should be granular enough to be easy to follow. But sometimes things go too far and you want to bring related commits together (e.g. missed deleting a file from the previous commit)</li>
<li><em>splitting</em> - if you've got a complex branch you could split it up into multiple branches and integrate them in gradually.</li>
</ul>


<p>All of this is possible by using interactive rebase - before it kicks off the operation, it displays the commits available and allows you to specify the operations to perform.</p>

<p><strong>Note:</strong> There's two minor differences when you squash commits together. One operation, <code>fixup</code>, is intended to merge a commit without including the commit message. The other, <code>squash</code>, will bring the commit message across and allow you to edit the commit message after the squash.</p>

<h3>Merging is overrated anyway</h3>

<p>Yes, that might be a controversial thing to say at this point. Merges are considered important to indicate when two branches have been brought together. But I submit to you, the jury of the internet - do we really need it? I'm not advocating abandoning merges at all - they have a purpose, which is to indicate changes additional to the branch being merged in.</p>

<p>If I can rebase a branch on top of the current master, I've just avoided the need for a merge commit completely (it becomes a fast-forward merge and the pointers are moved forward). I can then push and get on with the next task.</p>

<p>I guess this comes back to how you use branches. Git works excellently when you create a branch for a task, integrate the code into master, and delete the branch once its reached the end of its useful life.</p>

<p>Not everyone can work that way (that might be a rant for another day), but I see this a discipline issue rather than a pro/con of the tool itself.</p>

<h3>My Opinionated Git Flow</h3>

<p>So with a slight tweak to step 3, my flow becomes:</p>

<ol>
<li>Create a local branch for the feature</li>
<li>Work on your feature and get it reviewed -- you do code reviews, right?</li>
<li>Rebase the branch on master</li>
<li>Push the changes up to the remote repository</li>
</ol>


<p>How does that look from the comamnd line?</p>

<ul>
<li>git checkout -b ReallyCoolFeature master</li>
<li>... stuff gets done ...</li>
<li>git add -u .</li>
<li>git commit -m "#1234 implemented" -- associating commits with work items is awesomely helpful</li>
<li>git checkout master</li>
<li>git pull origin/master master</li>
<li>git rebase master ReallyCoolFeature</li>
<li>git checkout master</li>
<li>git merge ReallyCoolFeature --ff-only</li>
<li>git push origin master</li>
</ul>


<p>Combine that with some hot git alias action (this is getting fairly long as-is), you can strip away much of those commands into a simple "sync" step which you run against the branch you are working on.</p>

<h3>What's next?</h3>

<p>I could go on about using <code>reset</code> and <code>cherry-pick</code> commands and head further down the git rabbit hole, but I think the next posts should cover these things:</p>

<ul>
<li><code>git alias</code> - seriously, this is like crack for scripters</li>
<li>a general rant about discipline when managing commits - git has corrupted my brain, and I've found myself applying concepts to situations where I have used other VCSes (even TFS, not using git-tfs or tf-git)</li>
</ul>


</div>


	<div id="disqus_thread"></div>
<script type="text/javascript">
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://shiftkey.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>


</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
<script src="/js/plugins.js"></script>
<script src="/js/script.js"></script>

<!--[if (lt IE 9) & (!IEMobile)]>
<script src="/js/libs/DOMAssistantCompressed-2.8.js"></script>
<script src="/js/libs/selectivizr-1.0.1.js"></script>
<script src="/js/libs/respond.min.js"></script>
<![endif]-->

<script>
var _gaq=[['_setAccount','UA-8441214-1'],['_trackPageview']]; 
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<noscript>Your browser does not support JavaScript!</noscript>

</body>
</html>