<!DOCTYPE html>

<!-- 
320 and Up boilerplate extension
Author: Andy Clarke
Version: 0.9b
URL: http://stuffandnonsense.co.uk/projects/320andup 
-->

<!--[if IEMobile 7 ]><html class="no-js iem7" manifest="default.appcache?v=1"><![endif]-->
<!--[if lt IE 7 ]><html class="no-js ie6" lang="en"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7" lang="en"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8" lang="en"><![endif]-->
<!-- TODO: appcache definition -->
<!--[if (gte IE 9)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->

<head>
<meta charset="utf-8">

<title>Musing - Simpler UI Testing for WPF Apps</title>
<meta name="description" content="">
<meta name="author" content="brendan forster">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1">

<!-- robots -->
<meta name="robots" content="/robots.txt" />

<!-- For less capable mobile browsers
<link rel="stylesheet" media="handheld" href="css/handheld.css?v=1">  -->

<!-- For all browsers -->
<link rel="stylesheet" media="screen" href="/css/style.css?v=1">

<link rel="stylesheet" media="print" href="/css/print.css?v=1">
<!-- For progressively larger displays -->
<link rel="stylesheet" media="only screen and (min-width: 480px)" href="/css/480.css?v=1">
<link rel="stylesheet" media="only screen and (min-width: 768px)" href="/css/768.css?v=1">
<link rel="stylesheet" media="only screen and (min-width: 992px)" href="/css/992.css?v=1">
<link rel="stylesheet" media="only screen and (min-width: 1382px)" href="/css/1382.css?v=1">
<!-- For Retina displays -->
<link rel="stylesheet" media="only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)" href="/css/2x.css?v=1">

<link rel="stylesheet" media="screen" href="/css/custom.css?v=1">

<!-- JavaScript at bottom except for Modernizr -->
<script src="/js/libs/modernizr-1.7.min.js"></script>

<!-- For iPhone 4 -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/h/apple-touch-icon.png">
<!-- For iPad 1-->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/m/apple-touch-icon.png">
<!-- For iPhone 3G, iPod Touch and Android -->
<link rel="apple-touch-icon-precomposed" href="/img/l/apple-touch-icon-precomposed.png">
<!-- For Nokia -->
<link rel="shortcut icon" href="/img/l/apple-touch-icon.png">
<!-- For everything else -->
<link rel="shortcut icon" href="/favicon.ico">

<!--iOS. Delete if not required -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-startup-image" href="/img/splash.png">

<!--Microsoft. Delete if not required -->
<meta http-equiv="cleartype" content="on">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<!-- http://t.co/y1jPVnT -->
<link rel="canonical" href="simpler-ui-testing-for-wpf-apps.html">
</head>


<body class="clearfix">

<header role="banner" class="clearfix">
	<h1>Musing - Simpler UI Testing for WPF Apps</h1>
</header>

<div class="content clearfix">

	<div id="post">
<p>After spending some time this week getting to know Ruby and some of its testing frameworks (Shoulda, rspec, and TestCase), I thought I'd put pen
to paper and revisit why I started down this path.</p>

<p><strong>Some background</strong></p>

<p>The current project I am working on is a large data-driven WPF application, with a lot of complex scenarios to
identify, develop and test. There is a group of testers on the project, but I can see an opportunity to use
automated testing to verify functionality and allow testers to focus on areas of better value - exploratory testing, for example.</p>

<p>Yes, there are frameworks like <a href="http://white.codeplex.com/">White</a> or Coded UI Tests, but these tools were designed with developers in mind.
You have to write code like <a href="http://msdn.microsoft.com/en-us/magazine/dd483216.aspx">this</a> to drive the tests, and the tests are commonly written after the feature is implemented.</p>

<p><strong>Enter Automated Acceptance Testing</strong></p>

<p>In an ideal world, business users would define tests in an English-like language, which can then be translated into an executable
script and run against the application.</p>

<p>What I'm looking for in a framework for defining use cases:</p>

<ul>
<li>define the test first, so that the high-level scenario is set before development occurs</li>
<li>flexible with syntax for test cases - tailor scripts to suit people involved, while remaining declarative</li>
<li>integrate into deployment process to verify builds automated</li>
</ul>


<p><strong>Some inspiration from obscure corners</strong></p>

<p>When I first saw the syntax for <a href="http://msdn.microsoft.com/en-us/magazine/dd483216.aspx">webrat</a>, I was intrigued and jealous. To declare a test like this:</p>

<pre><code>class SignupTest &lt; ActionController::IntegrationTest

    def test_trial_account_sign_up
        visit home_path
        click_link "Sign up"
        fill_in "Email", :with =&gt; "good@example.com"
        select "Free account"
        click_button "Register"
    end
end
</code></pre>

<p>was not far off what I'd had in mind for something that was easy to follow and easy to write.</p>

<p>So I spent some time this week experimenting with various ways of achieving this against a sample WPF application.</p>

<p>I'm using rspec at the moment to run the test cases, and IronRuby and White to support the integration with the hosted WPF application.</p>

<p><strong>What does a test for the WPF application look like?</strong></p>

<pre><code>describe "new customers screen" do

    subject { Host.new(File.expand_path('./app/WpfTestApp.exe', File.dirname(__FILE__)))

    before(:each) do
        click "Add Customer"
    end

    it "cannot save empty form" do
        cannot_click "Save"
        can_click "Cancel"
    end

    it "can enter details for customer" do
        fill "FirstName", :with =&gt; "Brendan"
        fill "LastName", :with =&gt; "Forster"
        # and some other fields
        can_click "Save"
    end

    it "can save and return to main screen" do
        fill "FirstName", :with =&gt; "Brendan"
        fill "LastName", :with =&gt; "Forster"
        # and some other fields
        click "Save"
        assert_title "Dashboard"
    end

    after(:each) do
        cleanup
    end

    def method_missing(sym, *args, &amp;block)
        subject.send sym, *args, &amp;block
    end
end
</code></pre>

<p>The fields used here are based off the UI Automation features of the .NET Framework (some reading <a href="http://white.codeplex.com/">here</a> on recommendations)
which I'll dig into a bit later if people are interested.</p>

<p>The method_missing method is used to reduce the noise of writing "subject." to start each line - I'm not quite sold on the approach, but it was cleaner than the previous approaches I'd tried.
Also, rspec has a <a href="https://gist.github.com/663876">huge set of features</a> which I've barely scratched the surface on.</p>

<p>So with a set of files like the file above, the testrunner is a simple script to load specific files found in the current directory:</p>

<pre><code>require 'rubygems'
require 'rspec'
require 'host'

Dir[File.dirname(__FILE__) + '/*tests.rb'].each do |file| 
    load file
end
</code></pre>

<p>I'll share some more as I polish additional features (I'm most certainly doing Ruby wrong at the moment, so I keep refactoring code),
just needed to write this post.</p>

</div>


	<div id="disqus_thread"></div>
<script type="text/javascript">
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://shiftkey.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>


<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>07 Jul 2011</span> &raquo; <a href="doing-the-build-server-dance-with-nuget.html">Doing the build server dance with NuGet</a></li>
    
      <li><span>17 Jun 2011</span> &raquo; <a href="inotifypropertychanged-stop-the-madness.html">Soapbox: INotifyPropertyChanged - Stop the Madness</a></li>
    
      <li><span>07 Jun 2011</span> &raquo; <a href="on-the-windows-8-preview.html">On the Windows 8 Preview Video</a></li>
    
  </ul>
</div>

</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
<script src="/js/plugins.js"></script>
<script src="/js/script.js"></script>

<!--[if (lt IE 9) & (!IEMobile)]>
<script src="/js/libs/DOMAssistantCompressed-2.8.js"></script>
<script src="/js/libs/selectivizr-1.0.1.js"></script>
<script src="/js/libs/respond.min.js"></script>
<![endif]-->

<script>
var _gaq=[['_setAccount','UA-8441214-1'],['_trackPageview']]; 
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<noscript>Your browser does not support JavaScript!</noscript>

</body>
</html>